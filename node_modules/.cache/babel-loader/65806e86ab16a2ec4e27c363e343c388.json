{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import axiosInstance from'../axiosConfig';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserProfile=()=>{const[userData,setUserData]=useState(null);const[loading,setLoading]=useState(true);// Initialize loading state\nconst navigate=useNavigate();// Initialize navigate function\nuseEffect(()=>{const fetchUserData=async()=>{var _JSON$parse;const token=localStorage.getItem('token');const userId=(_JSON$parse=JSON.parse(localStorage.getItem('user')))===null||_JSON$parse===void 0?void 0:_JSON$parse.id;if(token&&userId){try{const response=await axiosInstance.get(`/api/user/id/${userId}`,{headers:{Authorization:`Bearer ${token}`}});const fetchedUserData=response.data;setUserData(fetchedUserData);// Set the fetched user data in the state\n// Update user data in localStorage\nlocalStorage.setItem('user',JSON.stringify(fetchedUserData));}catch(error){console.error('Failed to fetch user data:',error.response?error.response.data:error.message);navigate('/login');// Redirect to login if not authenticated or error\n}finally{setLoading(false);// Set loading to false after fetching\n}}else{console.error('No user data found, redirecting to login.');navigate('/login');// Redirect if no user data found\n}};fetchUserData();},[navigate]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Profile\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading user data...\"}):userData?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Username: \",userData.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Email: \",userData.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Full Name: \",userData.firstname,\" \",userData.lastname]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Phone Number: \",userData.phoneNumber]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Bio: \",userData.bio]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No user data available.\"})]});};export default UserProfile;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","axiosInstance","jsx","_jsx","jsxs","_jsxs","UserProfile","userData","setUserData","loading","setLoading","navigate","fetchUserData","_JSON$parse","token","localStorage","getItem","userId","JSON","parse","id","response","get","headers","Authorization","fetchedUserData","data","setItem","stringify","error","console","message","children","username","email","firstname","lastname","phoneNumber","bio"],"sources":["/home/rouaa/Desktop/social-media-front/src/components/UserProfile.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axiosInstance from '../axiosConfig';\n\nconst UserProfile = () => {\n  const [userData, setUserData] = useState(null);\n  const [loading, setLoading] = useState(true); // Initialize loading state\n  const navigate = useNavigate(); // Initialize navigate function\n\n  useEffect(() => {\n    const fetchUserData = async () => {\n      const token = localStorage.getItem('token');\n      const userId = JSON.parse(localStorage.getItem('user'))?.id;\n\n      if (token && userId) {\n        try {\n          const response = await axiosInstance.get(`/api/user/id/${userId}`, {\n            headers: {\n              Authorization: `Bearer ${token}`,\n            },\n          });\n          const fetchedUserData = response.data;\n          setUserData(fetchedUserData); // Set the fetched user data in the state\n\n          // Update user data in localStorage\n          localStorage.setItem('user', JSON.stringify(fetchedUserData)); \n        } catch (error) {\n          console.error('Failed to fetch user data:', error.response ? error.response.data : error.message);\n          navigate('/login'); // Redirect to login if not authenticated or error\n        } finally {\n          setLoading(false); // Set loading to false after fetching\n        }\n      } else {\n        console.error('No user data found, redirecting to login.');\n        navigate('/login'); // Redirect if no user data found\n      }\n    };\n\n    fetchUserData();\n  }, [navigate]);\n\n  return (\n    <div>\n      <h2>User Profile</h2>\n      {loading ? (\n        <p>Loading user data...</p>\n      ) : userData ? (\n        <div>\n          <p>Username: {userData.username}</p>\n          <p>Email: {userData.email}</p>\n          <p>Full Name: {userData.firstname} {userData.lastname}</p>\n          <p>Phone Number: {userData.phoneNumber}</p>\n          <p>Bio: {userData.bio}</p>\n        </div>\n      ) : (\n        <p>No user data available.</p>\n      )}\n    </div>\n  );\n};\n\nexport default UserProfile;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}